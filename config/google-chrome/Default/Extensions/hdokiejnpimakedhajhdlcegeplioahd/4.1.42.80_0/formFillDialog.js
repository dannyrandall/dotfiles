var FormFillDialog=function(t){VaultItemDialog.call(this,t,{additionalHeaderClasses:["icon"],closeButtonEnabled:!0,maximizeButtonEnabled:!0,buttonAlign:this.RIGHT_ALIGN})};FormFillDialog.prototype=Object.create(VaultItemDialog.prototype),FormFillDialog.prototype.constructor=FormFillDialog,function(t){var e=function(t){DialogInput.Input.call(this,void 0),this.customFieldElements=[],this.container=t};e.prototype=Object.create(DialogInput.Input.prototype),e.prototype.constructor=e,e.prototype.clear=function(){DialogInput.ErrorDisplayInput.prototype.clear.apply(this,arguments);for(var t=0,e=this.customFieldElements.length;t<e;++t){var i=this.customFieldElements[t];i.text.value="",i.value.value=""}},e.prototype.getValue=function(){for(var t=[],e=0,i=this.customFieldElements.length;e<i;++e){var o=this.customFieldElements[e],n={cfid:void 0===o.cfid?"0":o.cfid,text:o.text.value,value:o.value.value};("0"!==n.cfid||n.text||n.value)&&t.push(n)}return t},e.prototype.setValue=function(t){LPTools.removeDOMChildren(this.container),this.customFieldElements=[];for(var e=0,i=t.length;e<i||e<3;++e){var o=this.addElement();if(e<i){var n=t[e];o.text.value=n.text,o.value.value=n.value,o.cfid=n.cfid}}};var i=function(t,e){var i=LPTools.createElement("td");i.appendChild(e),t.appendChild(i)};e.prototype.addElement=function(){var t=LPTools.createElement("tr","settingsRow"),e=LPTools.createElement("textarea","dialogInput");i(t,e);var o=LPTools.createElement("textarea","dialogInput");i(t,o),this.container.appendChild(t);var n={text:e,value:o};return this.customFieldElements.push(n),n},e.prototype.validate=function(){return!0};var o=function(t,e){DialogInput.ErrorDisplayInput.call(this),this.container=t,this.countryCodeDropdown=e,this.countryCode=this.countryCodeDropdown.getValue(),this.value=null,this.initialized=!1,function(t){t.countryCodeDropdown.onChange(function(e){t.initialized||t.buildInput(),t.setCountryCode(e)})}(this)};o.prototype=Object.create(DialogInput.ErrorDisplayInput.prototype),o.prototype.constructor=o,o.prototype.getElement=function(){return this.container},o.prototype.validate=function(t,e,i){return!i||""!==this.countryCodeDropdown.getValue()||(t.addError(e,Strings.translateString("Country must be entered for this phone number.")),!1)},o.prototype.buildError=function(){return this.buildErrorElement({element:$(this.container)})},o.prototype.buildInput=function(){LPTools.removeDOMChildren(this.container),this.isDomestic()?(this.container.appendChild(document.createTextNode("(")),this.areaCodeInput=LPTools.createElement("input",{class:"dialogInput areaCode",type:"text",size:3,maxlength:3}),this.container.appendChild(this.areaCodeInput),this.container.appendChild(document.createTextNode(")")),this.phoneInput1=LPTools.createElement("input",{class:"dialogInput phonePartOne",type:"text",size:3,maxlength:3}),this.container.appendChild(this.phoneInput1),this.phoneInput2=LPTools.createElement("input",{class:"dialogInput phonePartTwo",type:"text",size:4,maxlength:4}),this.container.appendChild(this.phoneInput2)):(this.ccInput=LPTools.createElement("input",{type:"text",class:"dialogInput countryCode",size:3,maxlength:3,disabled:!0}),this.container.appendChild(this.ccInput),this.phoneInput=LPTools.createElement("input",{class:"dialogInput phone",type:"text"}),this.container.appendChild(this.phoneInput)),this.initialized=!0},o.prototype.isDomestic=function(){return"1"===PhoneFormatDropdown.prototype.COUNTRY_CODE_MAP[this.countryCode]},o.prototype.getNumericCountryCode=function(){return PhoneFormatDropdown.prototype.COUNTRY_CODE_MAP[this.countryCode]},o.prototype.setCountryCode=function(t){var e=this.isDomestic(),i=this.getValue(),o=this.getNumericCountryCode();i=o?i.substring(o.length):i,this.countryCode=t,e!==this.isDomestic()&&this.buildInput(),o=this.getNumericCountryCode(),this.setValue(o?o+i:"")},o.prototype.clear=function(){DialogInput.ErrorDisplayInput.prototype.clear.apply(this,arguments),this.areaCodeInput&&(this.areaCodeInput.value=""),this.phoneInput1&&(this.phoneInput1.value=""),this.phoneInput2&&(this.phoneInput2.value=""),this.ccInput&&(this.ccInput.value=""),this.phoneInput&&(this.phoneInput.value="")},o.prototype.getValue=function(){return this.initialized&&(this.isDomestic()?this.value="1"+this.areaCodeInput.value+this.phoneInput1.value+this.phoneInput2.value:this.value=this.ccInput.value+this.phoneInput.value),this.value},o.prototype.setValue=function(t){if(this.value=t,this.initialized)if(this.isDomestic())this.areaCodeInput.value=t.substring(1,4),this.phoneInput1.value=t.substring(4,7),this.phoneInput2.value=t.substring(7);else{var e=this.getNumericCountryCode();e?(this.ccInput.value=e,this.phoneInput.value=t.substring(e.length)):(this.ccInput.value="",this.phoneInput.value="")}},FormFillDialog.prototype.validate=function(t){var e=VaultItemDialog.prototype.validate.apply(this,arguments);return""===t.decprofilename&&(this.addError("decprofilename","Name is required."),e=!1),t.creditmon&&(""===t.firstname&&(this.addError("firstname","First Name is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.lastname&&(this.addError("lastname","Last Name is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.birthday&&(this.addError("birthday","Birthday is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.ssn&&(this.addError("ssn","Social Security Number is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.city&&(this.addError("city","City / Town is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.state&&(this.addError("state","State is required when Enable Free Credit Monitoring is checked."),e=!1),""===t.zip&&(this.addError("zip","ZIP / Postal Code is required when Enable Free Credit Monitoring is checked."),e=!1),t.phone.length<4&&(this.addError("phone","Phone Number is required when Enable Free Credit Monitoring is checked."),e=!1),"US"!==t.country&&(this.addError("country","Credit monitoring is only available for addresses in the United States."),e=!1)),e},FormFillDialog.prototype.open=function(t){t=t||{},t.title=t.title||(void 0===t.vaultItem?"Add Form Fill":"Edit Form Fill"),t.sourceFunction=LPProxy.getFormFillModel,VaultItemDialog.prototype.open.call(this,t)},FormFillDialog.prototype.buildPhoneInput=function(t,e,i,n){var l=LPTools.createElement("div"),r=new PhoneFormatDropdown;this.inputFields[e]=r,l.appendChild(r.getElement()[0]),t.appendChild(l);var a=LPTools.createElement("table","phoneNumber"),s=LPTools.createElement("tbody"),p=LPTools.createElement("tr");t.appendChild(a),a.appendChild(s),s.appendChild(p);var u=LPTools.createElement("td","phoneNumberCell");p.appendChild(u),this.inputFields[i]=new o(u,r),p.appendChild(LPTools.createElement("td","extensionLabel","ext."));var d=LPTools.createElement("td","extensionCell");p.appendChild(d);var h=LPTools.createElement("input",{class:"dialogInput",type:"text"});d.appendChild(h),this.inputFields[n]=new DialogInput.Input(h)},FormFillDialog.prototype.getData=function(t){var e=VaultItemDialog.prototype.getData.apply(this,arguments);void 0!==this.inputFields.state.options[e.state]?e.state_name=this.inputFields.state.options[e.state].label:e.state_name=e.state;for(var i=this.inputFields.country.getElement().prop("options"),o=0;o<i.length;o++)if(i[o].value===e.country){e.country_name=i[o].text,e.country_cc3l=i[o].getAttribute("data-cc3l");break}return e},FormFillDialog.prototype.defaultFields=function(t){t.defaultData=$.extend({profilelanguage:"en-US",profiletype:FormFill.prototype.FORM_FILL_TYPE_GENERIC},t.defaultData),VaultItemDialog.prototype.defaultFields.call(this,t)},FormFillDialog.prototype.initialize=function(t){VaultItemDialog.prototype.initialize.apply(this,arguments),function(t){t.inputFields.profiletype.onChange(function(e){e===FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD?t.$element.addClass("creditCard"):t.$element.removeClass("creditCard"),t.selectFirstLeftMenuItem()})}(this),this.inputFields.custom_fields=new e(document.getElementById("custom_fields")),function(t){$("#addCustomFieldButton").bind("click",function(){t.inputFields.custom_fields.addElement().text.focus()})}(this),this.buildPhoneInput(document.getElementById("formFillDialogPhoneInput"),"phone3lcc","phone","phoneext"),this.buildPhoneInput(document.getElementById("formFillDialogMobilePhoneInput"),"mobilephone3lcc","mobilephone","mobileext"),this.buildPhoneInput(document.getElementById("formFillDialogEveningPhoneInput"),"evephone3lcc","evephone","eveext"),this.buildPhoneInput(document.getElementById("formFillDialogFaxInput"),"fax3lcc","fax","faxext")},FormFillDialog.prototype.setup=function(t,e){e.vaultItem?this.inputFields.profiletype.disable():this.inputFields.profiletype.enable(),VaultItemDialog.prototype.setup.apply(this,arguments)},FormFillDialog.prototype.add=function(t){(new FormFill).addFromDialog(t,null,this.data.saveOptions)}}(document);