function LP_getElementByXPath(e,t){return e||(e=LP_derive_doc())?LP_lookupElementByXPath(e,t):null}function LP_getElementsByXPath(e,t){return e||(e=LP_derive_doc())?LP_lookupElementsByXPath(e,t):null}function LP_createXPathFromElement(e,t){if(!e&&!(e=LP_derive_doc()))return null;if(!t)return null;var a,n,i=e.getElementsByTagName("*");if(i.length>0&&(void 0===i[0].hasAttribute||void 0===i[0].localName))return LP_getXPath(t);for(segs=[];t&&1==t.nodeType;t=t.parentNode)if(t.hasAttribute("id")){for(var o=0,l=0;l<i.length&&(i[l].hasAttribute("id")&&i[l].id==t.id&&o++,!(o>1));l++);if(1==o)return segs.unshift('id("'+t.getAttribute("id")+'")'),segs.join("/");for(var r=t.parentNode?t.parentNode.children:[],u=0,s=0;s<r.length&&(void 0!==r[s].hasAttribute&&r[s].hasAttribute("id")&&r[s].id==t.id&&u++,!(u>1));s++);if(u>1){for(a=1,n=t.previousSibling;n;n=n.previousSibling)n.localName==t.localName&&a++;segs.unshift(t.localName.toLowerCase()+"["+a+"]")}else segs.unshift(t.localName.toLowerCase()+'[@id="'+t.getAttribute("id")+'"]')}else if(t.hasAttribute("name"))segs.unshift(t.localName.toLowerCase()+'[@name="'+t.getAttribute("name")+'"]');else if(t.hasAttribute("action")&&"FORM"==t.nodeName.toUpperCase())segs.unshift(t.localName.toLowerCase()+'[@action="'+t.getAttribute("action")+'"]');else if(t.hasAttribute("class"))segs.unshift(t.localName.toLowerCase()+'[contains(@class,"'+t.getAttribute("class")+'")]');else{for(a=1,n=t.previousSibling;n;n=n.previousSibling)n.localName==t.localName&&a++;segs.unshift(t.localName.toLowerCase()+"["+a+"]")}return segs.length?"/"+segs.join("/"):null}function LP_lookupElementByXPath(e,t){return e&&e.documentElement?g_isfirefox&&e&&!e.defaultView?null:"undefined"==(g_isfirefox?typeof e.defaultView.XPathEvaluator:typeof XPathEvaluator)?null:(g_isfirefox?new e.defaultView.XPathEvaluator:new XPathEvaluator).evaluate(t,e.documentElement,null,g_isfirefox?e.defaultView.XPathResult.FIRST_ORDERED_NODE_TYPE:XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue:null}function LP_lookupElementsByXPath(e,t){var a=[];if(!e||!e.documentElement)return a;if("undefined"==(g_isfirefox?typeof e.defaultView.XPathEvaluator:typeof XPathEvaluator))return a;var n=g_isfirefox?new e.defaultView.XPathEvaluator:new XPathEvaluator,i=n.evaluate(t,e.documentElement,null,g_isfirefox?e.defaultView.XPathResult.ORDERED_NODE_ITERATOR_TYPE:XPathResult.ORDERED_NODE_ITERATOR_TYPE,null);if(i)for(var o=i.iterateNext();o;)o&&a.push(o),o=i.iterateNext();return a}function LP_getXPath(e){function t(e){return"undefined"!=typeof Document?e instanceof Document:e&&e.nodeType==n}var a,n=9,i=[],o="";if(t(e))return"/";for(;e&&!t(e);e=2==e.nodeType?e.ownerElement:e.parentNode){switch(a=i[i.length]={},e.nodeType){case 1:a.name="text()";break;case 2:a.name="@"+e.nodeName;break;case 7:a.name="processing-instruction()";break;case 8:a.name="comment()";break;case 3:a.name=e.nodeName}a.position=function(e){var t,a=1;if(2==e.nodeType)return null;for(t=e.previousSibling;t;t=t.previousSibling)t.nodeName==e.nodeName&&++a;return a}(e)}for(var l=i.length-1;l>=0;l--)a=i[l],o+="/"+a.name,null!=a.position&&(o+="["+a.position+"]");return o}if(void 0===Node)var Node={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};