User=function(e,t,i){this._username=e,this._accountClass=t,this._element=null,this._userMenuText=null,this._identities=i,this._identityDropdown=null,function(e){e.identityEnableCallback=function(t){if(e._identityDropdown&&e._identityDropdown.setValue(t._data.deciname,!1),e._userMenuText.children().detach(),t instanceof AllIdentity)e._userMenuText.append(e._userInfo);else{var i=LPTools.createElement("ul","userMenuText");i.appendChild(LPTools.createElement("li","userMenuTextSingle truncateShort",t.getName())),e._userMenuText.append(i)}},e.identityAddedCallback=function(t){e._identities.push(t),e._identityDropdown?e._identityDropdown.setIdentities(e._identities):e.initializeIdentityDropdown(e._element.get(0).firstChild)},Topics.get(Topics.IDENTITY_ENABLE).subscribe(e.identityEnableCallback),Topics.get(Topics.IDENTITY_ADDED).subscribe(e.identityAddedCallback)}(this)},function(e){User.prototype.destruct=function(){this._element.unbind(),this._element.empty(),this._userMenuText.empty(),Topics.get(Topics.IDENTITY_ENABLE).unsubscribe(this.identityEnableCallback),Topics.get(Topics.IDENTITY_ADDED).unsubscribe(this.identityAddedCallback),this._username=null,this._accountClass=null,this._element=null,this._userMenuText=null,this._identities=null,this._identityDropdown=null};var t=function(e,t,i,n,s){s=s||{},s.id=i,s.class="menuListItem";var l=LPTools.createElement("li"),o=LPTools.createElement(t,s);return o.textContent=n,l.appendChild(o),e.appendChild(l),l};User.prototype.initializeIdentityDropdown=function(e){var t=LPTools.createElement("li","menuListHeader identityDropdownMenuItem");t.appendChild(LPTools.createElement("div",{id:"identityDropdownContainer"})),t.children[0].appendChild(LPTools.createElement("img",{id:"identityDropdownIcon",src:"images/vault_4.0/Identity_Avatar.png"}));var i=LPTools.createElement("div");t.children[0].appendChild(i);var n=LPTools.createElement("input",{id:"identityDropdown",class:"dialogInput selectDropdown",type:"text"});i.appendChild(n),e.insertBefore(t,e.firstChild),this._identityDropdown=new IdentityDropdown(n,this._identities);for(var s=0,l=this._identities.length;s<l;++s){var o=this._identities[s];o._enabled&&this._identityDropdown.setValue(o.getName(),!1)}LPPlatform.addEventListener(t,"click",function(e){e.stopPropagation()}),$(t.nextElementSibling).addClass("divider")},User.prototype.initialize=function(e,i){var n=LPTools.createElement("ul");this._userInfo=LPTools.createElement("ul","userMenuText"),this._userInfo.appendChild(LPTools.createElement("li","userMenuTextPrimary truncateShort",this._username)),this._userInfo.appendChild(LPTools.createElement("li","userMenuTextSecondary",Strings.translateString(this._accountClass))),i.append(this._userInfo),$(t(n,"div","vaultToggleIcon",Strings.Vault.VAULT_TOGGLE)).bind("click",function(){bg.VaultToggle.toggleVault3_0()}),$(t(n,"div","accountSettingsIcon",Strings.Vault.ACCOUNT_SETTINGS)).bind("click",function(){Topics.get(Topics.EDIT_SETTINGS).publish()}),$(t(n,"a","helpCenterIcon",Strings.Vault.HELP_CENTER,{href:"https://lastpass.com/support_helpcenter.php",target:"_blank"})).bind("click",function(){window.open("https://lastpass.com/support_helpcenter.php")}),$(t(n,"div","logoutIcon",Strings.Vault.LOGOUT)).bind("click",LPProxy.logout),e.append(n),this._identities.length>1&&this.initializeIdentityDropdown(n),this._element=e,this._userMenuText=i},User.prototype.isFree=function(){return this._accountClass===Constants.USER_FREE}}(document);